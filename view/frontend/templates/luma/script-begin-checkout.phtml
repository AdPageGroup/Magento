<?php 
declare(strict_types=1);

use Magento\Framework\View\Element\Template;
use Tagging\GTM\DataLayer\Event\BeginCheckout;

/** @var Template $block */
/** @var BeginCheckout $beginCheckoutEvent */

$beginCheckoutEvent = $block->getData('begin_checkout_event');

// Get SecureHtmlRenderer using Object Manager for compatibility
$objectManager = \Magento\Framework\App\ObjectManager::getInstance();
$secureRenderer = $objectManager->get(\Magento\Framework\View\Helper\SecureHtmlRenderer::class);

$eventData = json_encode($beginCheckoutEvent->get());
$scriptContent = "window.Tagging_GTM_BEGIN_CHECKOUT = {$eventData};";

echo $secureRenderer->renderTag('script', ['type' => 'text/javascript'], $scriptContent, false);
?>